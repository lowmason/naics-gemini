# Pre-commit Hooks Setup

This repository uses [pre-commit](https://pre-commit.com/) to run automated checks before each commit.

## Initial Setup

1. **Install pre-commit** (if not already installed):
   ```bash
   uv pip install pre-commit
   # or
   uv sync --group dev
   ```

2. **Install the git hooks**:
   ```bash
   uv run pre-commit install
   ```

   This installs hooks that run automatically on `git commit`.

## What Runs on Commit

The pre-commit hooks will automatically:

- ✅ **Check code formatting** (ruff format)
- ✅ **Run linting** (ruff check with auto-fix)
- ✅ **Validate YAML/JSON/TOML files**
- ✅ **Check for trailing whitespace and merge conflicts**
- ✅ **Run code coverage check** (pytest with coverage)

## Running Manually

You can run all hooks manually on all files:

```bash
uv run pre-commit run --all-files
```

Or run a specific hook:

```bash
uv run pre-commit run coverage-check --all-files
```

## Coverage Threshold

By default, the coverage check reports coverage but doesn't fail. To enforce a minimum coverage threshold:

```bash
# Set threshold to 80%
COVERAGE_THRESHOLD=80 uv run pre-commit run coverage-check --all-files

# Or set it globally for all commits
export COVERAGE_THRESHOLD=80
uv run pre-commit install
```

## Skipping Hooks (Not Recommended)

If you need to skip hooks for a specific commit:

```bash
git commit --no-verify -m "Emergency fix"
```

## Updating Hooks

To update hook versions:

```bash
uv run pre-commit autoupdate
```

